<!DOCTYPE html>
<!-- saved from url=(0058)http://progexercise.dev.indeed.net/progcontest/problems/10 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="shortcut icon" href="http://progexercise.dev.indeed.net/progcontest/img/favicon.png">
    <link rel="stylesheet" type="text/css" href="./J-Tea_Cups_files/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="./J-Tea_Cups_files/custom.css">
    <link rel="stylesheet" type="text/css" href="./J-Tea_Cups_files/custom.css">
    <script type="text/javascript" src="./J-Tea_Cups_files/jquery.js"></script>
    <script type="text/javascript" src="./J-Tea_Cups_files/bootstrap.js"></script>
    <script type="text/javascript" src="./J-Tea_Cups_files/timer.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $("#contestCountdown").countdownTimer({
                endpoint: "/progcontest/api/timeRemaining/contest"
            });
        })
    </script>
    <title>Indeed Coding Duel</title>
<style type="text/css"></style></head>
<body style="">
<div class="navbar">
    <div class="navbar-inner">
        <div class="container-fluid">
            <a class="brand" href="http://progexercise.dev.indeed.net/progcontest/">
                <img id="headerLogo" src="./J-Tea_Cups_files/logo.png"> Coding Duel
            </a>
            <ul class="nav">
                        <li class="active"><a href="http://progexercise.dev.indeed.net/progcontest/problems">Problems</a></li>

                        <li><a href="http://progexercise.dev.indeed.net/progcontest/submissions">My Submissions</a></li>

            </ul>
            <ul class="nav pull-right">
                    <li class="navbar-text" id="contestCountdown">
                        <span class="countdownLabel">Time remaining</span>:
                        <span class="timeRemaining">contest has ended</span>
                    </li>
                <li class="divider-vertical"></li>
                        <li><a href="http://progexercise.dev.indeed.net/progcontest/profile">Profile</a></li>

                    <li><a href="http://progexercise.dev.indeed.net/progcontest/logout">Logout</a></li>
            </ul>
        </div>
    </div>
</div>
<div class="container-fluid">
    <div class="row-fluid">
        <div class="span3" style="max-width: 250px;">
            <ul class="nav nav-pills nav-stacked">
                    <li class="">
                        <a href="http://progexercise.dev.indeed.net/progcontest/problems/1">A: Collatz
                            <i class="icon-ok "></i>
                        </a>
                    </li>
                    <li class="">
                        <a href="http://progexercise.dev.indeed.net/progcontest/problems/2">B: Binary Tape
                            <i class="icon-ok "></i>
                        </a>
                    </li>
                    <li class="">
                        <a href="http://progexercise.dev.indeed.net/progcontest/problems/3">C: T-Shirts
                            <i class="icon-ok "></i>
                        </a>
                    </li>
                    <li class="">
                        <a href="http://progexercise.dev.indeed.net/progcontest/problems/4">D: String manipulation
                            <i class="icon-ok "></i>
                        </a>
                    </li>
                    <li class="">
                        <a href="http://progexercise.dev.indeed.net/progcontest/problems/5">E: Elections
                            
                        </a>
                    </li>
                    <li class="">
                        <a href="http://progexercise.dev.indeed.net/progcontest/problems/6">F: Pivot the Board
                            
                        </a>
                    </li>
                    <li class="">
                        <a href="http://progexercise.dev.indeed.net/progcontest/problems/7">G: Gathering Diamonds
                            
                        </a>
                    </li>
                    <li class="">
                        <a href="http://progexercise.dev.indeed.net/progcontest/problems/8">H: Slippery Floor
                            
                        </a>
                    </li>
                    <li class="">
                        <a href="http://progexercise.dev.indeed.net/progcontest/problems/9">I: Tower of coins
                            
                        </a>
                    </li>
                    <li class="active">
                        <a href="./J-Tea_Cups_files/J-Tea_Cups.html">J: Tea cups
                            
                        </a>
                    </li>
            </ul>

            <ul class="nav nav-pills nav-stacked">
    <li>                    <a href="http://progexercise.dev.indeed.net/progcontest/problems/clarifications" class="read">
                        Clarifications 
                    </a>
</li>
            </ul>

                <hr>

                <div id="problemStatus" class="well">
                        <form action="http://progexercise.dev.indeed.net/progcontest/attempt" method="POST">
                            <input type="hidden" name="problemId" value="10">
                            <input id="attemptButton" type="submit" class="btn" value="Solve this problem">

                            <div>When you press this button, an input file will be generated. You will have to submit
                            the corresponding output within <strong>4 minutes</strong>,
                            or else your submission will be marked incorrect.
                            </div>
                        </form>
                </div>
        </div>
        <div class="span7">
                <h2>J: Tea cups</h2>
                <div class="description"><p>﻿Many amusement parks have teacup rides.
These consist of <code>N</code> identical cups evenly distributed on the perimeter of a circle, in which fair-goers can ride.
All of the cups rotate independently, and the entire ride rotates as well.
In our park, all cups have 3 locations that can be painted different colors.</p>

<p>There are <code>K</code> colors, which can be given values from 1 to <code>K</code> (inclusive).
The colors are assigned numbers in ascending order of lightness. 1 is the darkest, and <code>K</code> is the lightest.</p>

<p>Each of the 3 painted locations have a dirtiness value, which is determined by a pseudo-random number generator as described in the input section.
No cup can be painted a color with a larger value than its dirtiness value. 
That is, if <code>K</code> is 7, a location with dirtiness value 3 can only be painted colors 1, 2, or 3, and a location with dirtiness value 1 must be painted color 1.</p>

<p>If two particular starting configurations can be rotated into the same position, they are considered the same coloring.</p>

<p>How many unique colorings exist?</p>

<h1>Input:</h1>

<ol>
<li>The first line gives T (1≦T≦100), the number of test cases.</li>
<li>T lines follow, each giving a test case.</li>
<li>The test cases are each one line of the form: <code>N K A<sub>1</sub> B<sub>1</sub> C<sub>1</sub> A<sub>2</sub> B<sub>2</sub> C<sub>2</sub> A<sub>3</sub> B<sub>3</sub> C<sub>3</sub></code>
<ol>
<li><code>N</code> (1≦<code>N</code>≦10<sup>5</sup>) is the number of teacups.</li>
<li><code>K</code> (1≦<code>K</code>≦10<sup>9</sup>) is the number of colors available.</li>
<li>1 ≦ <code>A<sub>1</sub></code>, <code>B<sub>1</sub></code>, <code>C<sub>1</sub></code>, <code>A<sub>2</sub></code>, <code>B<sub>2</sub></code>, <code>C<sub>2</sub></code>, <code>A<sub>3</sub></code>, <code>B<sub>3</sub></code>, <code>C<sub>3</sub></code> ≦ <code>K</code>, and are the parameters of the pseudo-random number generator.</li>
<li><code>D<sub>j,k</sub></code>, the dirtiness of the j<sup>th</sup> cup’s k<sup>th</sup> surface location is determined by the random number generator as follows:
<ol>
<li>if <code>j = 1, D<sub>j,k</sub> = C<sub>k</sub></code></li>
<li>if <code>j &gt; 1, D<sub>j,k</sub> = ((D<sub>j-1,k</sub>*A<sub>j</sub> + B<sub>j</sub>) mod K) + 1</code></li>
</ol></li>
</ol></li>
</ol>

<h1>Output:</h1>

<p>For each test case, output the number of indistinguishable colorings possible, followed by a new line.</p>

<h1>Sample input:</h1>

<pre><code>4
2 2 1 1 1 1 1 1 1 1 1
4 3 2 1 3 2 2 1 2 2 1
6 8 1 5 7 7 4 5 3 2 6
1234 4321 123 234 345 3210 2345 678 1234 876 987
</code></pre>

<h1>Sample output:</h1>

<pre><code>1
2
5
195612
</code></pre>
</div>
        </div>
        <div class="span2">
    <div style="text-align: center;"><h4>Clarifications for J: Tea cups</h4></div>
        <div>There have been no clarifications posted.</div>
    <div id="clarifications">
    </div>
        </div>
    </div>
</div>


<script id="hiddenlpsubmitdiv" style="display: none;"></script><script>try{for(var lastpass_iter=0; lastpass_iter < document.forms.length; lastpass_iter++){ var lastpass_f = document.forms[lastpass_iter]; if(typeof(lastpass_f.lpsubmitorig2)=="undefined"){ lastpass_f.lpsubmitorig2 = lastpass_f.submit; lastpass_f.submit = function(){ var form=this; var customEvent = document.createEvent("Event"); customEvent.initEvent("lpCustomEvent", true, true); var d = document.getElementById("hiddenlpsubmitdiv"); if (d) {for(var i = 0; i < document.forms.length; i++){ if(document.forms[i]==form){ d.innerText=i; } } d.dispatchEvent(customEvent); }form.lpsubmitorig2(); } } }}catch(e){}</script></body></html>